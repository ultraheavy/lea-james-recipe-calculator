<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Lea Jane's Recipe Calculator{% endblock %}</title>
    <link rel="stylesheet" href="/static/css/design-system.css">
    <link rel="stylesheet" href="/static/css/fam-hospitality.css">
    <link rel="stylesheet" href="/static/css/food-icons.css">
    <link rel="stylesheet" href="/static/css/responsive-navigation.css">
    <link rel="stylesheet" href="/static/css/mobile-buttons.css">
    <link rel="stylesheet" href="/static/css/responsive-tables.css">
    {% block extra_css %}{% endblock %}
</head>
<body class="theme-fam">
    <!-- FAM Navigation -->
    <nav class="fam-nav">
        <div class="fam-container">
            <div class="fam-nav-content">
                <!-- Brand -->
                <a href="/" class="fam-brand">
                    <div class="fam-logo">LJ</div>
                    <span>Lea Jane's</span>
                </a>
                
                <!-- Mobile Menu Toggle -->
                <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 12h18M3 6h18M3 18h18"/>
                    </svg>
                </button>
                
                <!-- Main Menu -->
                <div class="fam-nav-menu navbar-menu" id="navbarMenu">
                    <!-- Mobile Menu Header -->
                    <div class="mobile-menu-header mobile-only">
                        <div class="fam-logo" style="width: 40px; height: 40px; font-size: 1rem;">LJ</div>
                        <button class="mobile-menu-close" onclick="closeMobileMenu()">√ó</button>
                    </div>
                    
                    <!-- Navigation Links -->
                    <a href="/" class="fam-nav-link navbar-link {% if request.endpoint == 'index' %}active{% endif %}">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                        </svg>
                        <span>Dashboard</span>
                    </a>
                    <a href="/inventory" class="fam-nav-link navbar-link {% if request.endpoint == 'inventory' %}active{% endif %}">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M20 7H4a2 2 0 00-2 2v9a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2z"/>
                        </svg>
                        <span>Inventory</span>
                    </a>
                    <a href="/recipes" class="fam-nav-link navbar-link {% if request.endpoint == 'recipes' %}active{% endif %}">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                        </svg>
                        <span>Recipes</span>
                    </a>
                    <a href="/menu_items" class="fam-nav-link navbar-link {% if request.endpoint == 'menu' %}active{% endif %}">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="4" y="4" width="16" height="16" rx="2"/>
                        </svg>
                        <span>Recipe Assignment</span>
                    </a>
                    <a href="/menus_mgmt" class="fam-nav-link navbar-link {% if request.endpoint == 'menus' or request.endpoint == 'edit_menu' %}active{% endif %}">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                        <span>Menus</span>
                    </a>
                    <a href="/pricing-analysis" class="fam-nav-link navbar-link {% if request.endpoint == 'pricing_analysis' %}active{% endif %}">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                        </svg>
                        <span>Analytics</span>
                    </a>
                    <a href="/vendors" class="fam-nav-link navbar-link {% if request.endpoint == 'vendors' %}active{% endif %}">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                        </svg>
                        <span>Vendors</span>
                    </a>
                    
                    <!-- Theme Selector in Mobile Menu -->
                    <div class="mobile-only theme-dots">
                        <a href="/set-theme/modern" class="theme-dot" title="Modern" style="background: #6366f1;"></a>
                        <a href="/set-theme/neo" class="theme-dot" title="Neo Tokyo" style="background: linear-gradient(135deg, #ff006e, #00f5ff);"></a>
                        <a href="/set-theme/fam" class="theme-dot active" title="FAM Hospitality" style="background: #4DB6AC;"></a>
                    </div>
                </div>
                
                <!-- Desktop Theme Switcher -->
                <div class="desktop-only" style="margin-left: auto;">
                    <select onchange="window.location.href='/set-theme/' + this.value" class="fam-form-control theme-selector" style="width: auto; padding: 0.5rem 1rem; font-size: 0.875rem;">
                        <option value="modern">Modern Theme</option>
                        <option value="neo">Neo Tokyo</option>
                        <option value="fam" selected>FAM Hospitality</option>
                    </select>
                </div>
                
                <!-- Mobile Menu Backdrop (inside nav for proper stacking) -->
                <div class="mobile-menu-backdrop" id="mobileMenuBackdrop" onclick="closeMobileMenu()"></div>
            </div>
        </div>
    </nav>
    
    <!-- Main Content -->
    <main style="padding: 2rem 0; min-height: calc(100vh - 100px);">
        <div class="fam-container">
            {% block content %}{% endblock %}
        </div>
    </main>
    
    <!-- Food Icon Helper Script -->
    <script>
    function getFoodCategory(name) {
        const lowerName = name.toLowerCase();
        if (lowerName.includes('chicken') || lowerName.includes('beef') || lowerName.includes('pork') || 
            lowerName.includes('lamb') || lowerName.includes('turkey') || lowerName.includes('meat')) {
            return 'protein';
        } else if (lowerName.includes('milk') || lowerName.includes('cheese') || lowerName.includes('cream') || 
                   lowerName.includes('butter') || lowerName.includes('yogurt')) {
            return 'dairy';
        } else if (lowerName.includes('tomato') || lowerName.includes('lettuce') || lowerName.includes('onion') || 
                   lowerName.includes('pepper') || lowerName.includes('vegetable') || lowerName.includes('produce')) {
            return 'produce';
        } else if (lowerName.includes('bread') || lowerName.includes('pasta') || lowerName.includes('rice') || 
                   lowerName.includes('flour') || lowerName.includes('grain')) {
            return 'grains';
        } else if (lowerName.includes('water') || lowerName.includes('juice') || lowerName.includes('soda') || 
                   lowerName.includes('beverage') || lowerName.includes('drink')) {
            return 'beverage';
        } else if (lowerName.includes('spice') || lowerName.includes('salt') || lowerName.includes('pepper') || 
                   lowerName.includes('seasoning')) {
            return 'spices';
        } else if (lowerName.includes('oil') || lowerName.includes('vinegar') || lowerName.includes('cooking')) {
            return 'oil';
        } else if (lowerName.includes('frozen') || lowerName.includes('ice')) {
            return 'frozen';
        } else if (lowerName.includes('dessert') || lowerName.includes('cake') || lowerName.includes('sweet')) {
            return 'dessert';
        } else if (lowerName.includes('fish') || lowerName.includes('shrimp') || lowerName.includes('seafood')) {
            return 'seafood';
        } else if (lowerName.includes('sauce') || lowerName.includes('dressing') || lowerName.includes('condiment')) {
            return 'sauce';
        } else if (lowerName.includes('appetizer') || lowerName.includes('starter')) {
            return 'appetizer';
        }
        return 'misc';
    }
    
    function createFoodIcon(text, size = 'md') {
        const category = getFoodCategory(text);
        const div = document.createElement('div');
        div.className = `food-icon icon-${category} food-icon-${size}`;
        
        // Add icon content based on category
        const iconMap = {
            'protein': 'ü•©',
            'dairy': 'ü•õ',
            'produce': 'ü•¨',
            'grains': 'üåæ',
            'beverage': 'ü•§',
            'spices': 'üßÇ',
            'oil': 'ü´í',
            'frozen': '‚ùÑÔ∏è',
            'dessert': 'üç∞',
            'seafood': 'üêü',
            'sauce': 'ü•´',
            'appetizer': 'üç§',
            'misc': 'üì¶'
        };
        
        div.innerHTML = `<span style="font-size: 1.25rem;">${iconMap[category] || 'üì¶'}</span>`;
        return div;
    }
    </script>
    
    <!-- Mobile Navigation Script -->
    <script>
        // Mobile menu toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('navbarMenu');
            const backdrop = document.getElementById('mobileMenuBackdrop');
            menu.classList.toggle('active');
            backdrop.classList.toggle('active');
            
            // Prevent body scroll when menu is open
            if (menu.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }
        
        // Close mobile menu
        function closeMobileMenu() {
            const menu = document.getElementById('navbarMenu');
            const backdrop = document.getElementById('mobileMenuBackdrop');
            menu.classList.remove('active');
            backdrop.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        // Close mobile menu on click outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('navbarMenu');
            const toggle = document.querySelector('.mobile-menu-toggle');
            if (!menu.contains(event.target) && !toggle.contains(event.target)) {
                closeMobileMenu();
            }
        });
        
        // Close mobile menu with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeMobileMenu();
            }
        });
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>